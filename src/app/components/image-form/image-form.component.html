@defer {
  <img
    class="image-preview"
    [src]="null"
    default="assets/image-placeholder.png"
    alt="Image preview" />
} @placeholder (minimum 0.5s) {
  <div class="lcc-content-placeholder-wrapper loading-placeholder-image">
    <div class="lcc-content-placeholder"></div>
  </div>
}

<form
  class="lcc-form"
  [formGroup]="form"
  (ngSubmit)="onSubmit()">
  <div class="lcc-form-fields">
    <label
      class="upload-new-image-button lcc-secondary-button"
      type="button"
      tooltip="Upload new image">
      <input
        type="file"
        accept="image/*"
        (change)="onUploadNewImages($event)" />
      <i-feather name="upload"></i-feather>
    </label>

    <label
      for="caption-input"
      class="lcc-required-field">
      Caption:
    </label>
    <input
      id="caption-input"
      type="text"
      name="caption"
      formControlName="caption"
      maxlength="120" />
    <div class="lcc-form-error-container">
      @if (hasError(form.controls.caption)) {
        <i-feather
          name="alert-triangle"
          class="lcc-form-error-icon validation-alert-icon"
          [tooltip]="getErrorMessage(form.controls.caption)">
        </i-feather>
      }
    </div>
  </div>

  @if (originalImage?.modificationInfo; as info) {
    <lcc-modification-info [info]="info"></lcc-modification-info>
  }

  <div class="lcc-form-buttons-container">
    <button
      class="lcc-secondary-button"
      type="button"
      (click)="onCancel()">
      Cancel
    </button>
    <button
      class="lcc-primary-button"
      type="submit"
      [disabled]="form.invalid || !hasUnsavedChanges">
      {{ originalImage ? 'Update' : 'Add image' }}
    </button>
  </div>
</form>
